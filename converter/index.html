<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>银行出入金自动解析</title>
  <style>
    @font-face {
      font-family: "Chinese Quote";
      src: local("PingFang SC"), local("SimSun");
      unicode-range: U+2018, U+2019, U+201c, U+201d;
    }

    body {
      margin: 0;
      padding: 0;
    }

    html,
    body {
      width: 100%;
      height: 100%;
    }

    input::-ms-clear,
    input::-ms-reveal {
      display: none;
    }

    html {
      font-family: sans-serif;
      line-height: 1.15;
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
      -ms-overflow-style: scrollbar;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    *,
    *::before,
    *::after {
      -webkit-box-sizing: border-box;
      box-sizing: border-box;
    }

    ul,
    ol {
      list-style: none;
    }

    @font-face {
      font-family: "anticon";
      font-display: fallback;
      src: url("https://at.alicdn.com/t/font_148784_v4ggb6wrjmkotj4i.eot");
      /* IE9*/
      src: url("https://at.alicdn.com/t/font_148784_v4ggb6wrjmkotj4i.woff") format("woff"),
        /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
        url("https://at.alicdn.com/t/font_148784_v4ggb6wrjmkotj4i.ttf") format("truetype"),
        /* iOS 4.1- */
        url("https://at.alicdn.com/t/font_148784_v4ggb6wrjmkotj4i.svg#iconfont") format("svg");
    }

    .anticon {
      display: inline-block;
      font-style: normal;
      vertical-align: baseline;
      text-align: center;
      text-transform: none;
      line-height: 1;
      text-rendering: optimizeLegibility;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .anticon-info-circle-o:before {
      content: "\E629";
    }

    .anticon:before {
      display: block;
      font-family: "anticon" !important;
    }

    .ant-input {
      font-family: "Chinese Quote", -apple-system, BlinkMacSystemFont,
        "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
        "Helvetica Neue", Helvetica, Arial, sans-serif, "Apple Color Emoji",
        "Segoe UI Emoji", "Segoe UI Symbol";
      font-variant: tabular-nums;
      -webkit-box-sizing: border-box;
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      list-style: none;
      position: relative;
      display: inline-block;
      padding: 4px 11px;
      width: 100%;
      height: 32px;
      font-size: 14px;
      line-height: 1.5;
      color: rgba(0, 0, 0, 0.65);
      background-color: #fff;
      background-image: none;
      border: 1px solid #d9d9d9;
      border-radius: 4px;
      -webkit-transition: all 0.3s;
      transition: all 0.3s;
    }

    textarea.ant-input {
      max-width: 100%;
      height: auto;
      vertical-align: bottom;
      -webkit-transition: all 0.3s, height 0s;
      transition: all 0.3s, height 0s;
      min-height: 32px;
    }

    .ant-btn {
      line-height: 1.5;
      display: inline-block;
      font-weight: 400;
      text-align: center;
      -ms-touch-action: manipulation;
      touch-action: manipulation;
      cursor: pointer;
      background-image: none;
      border: 1px solid transparent;
      white-space: nowrap;
      padding: 0 15px;
      font-size: 14px;
      border-radius: 4px;
      height: 32px;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);
      transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);
      position: relative;
      color: rgba(0, 0, 0, 0.65);
      background-color: #fff;
      border-color: #d9d9d9;
    }

    .ant-btn,
    .ant-btn:active,
    .ant-btn:focus {
      outline: 0;
    }

    .ant-btn:not([disabled]):hover {
      text-decoration: none;
    }

    .ant-btn:not([disabled]):active {
      outline: 0;
      -webkit-transition: none;
      transition: none;
    }

    .ant-btn:hover,
    .ant-btn:focus {
      color: #40a9ff;
      background-color: #fff;
      border-color: #40a9ff;
    }

    .ant-btn:active,
    .ant-btn.active {
      color: #096dd9;
      background-color: #fff;
      border-color: #096dd9;
    }

    .ant-btn:hover,
    .ant-btn:focus,
    .ant-btn:active,
    .ant-btn.active {
      background: #fff;
      text-decoration: none;
    }

    .ant-btn>i,
    .ant-btn>span {
      pointer-events: none;
    }

    .ant-btn-primary {
      color: #fff;
      background-color: #1890ff;
      border-color: #1890ff;
    }

    .ant-btn-primary:hover,
    .ant-btn-primary:focus {
      color: #fff;
      background-color: #40a9ff;
      border-color: #40a9ff;
    }

    .ant-btn-primary:active,
    .ant-btn-primary.active {
      color: #fff;
      background-color: #096dd9;
      border-color: #096dd9;
    }

    .ant-btn:before {
      position: absolute;
      top: -1px;
      left: -1px;
      bottom: -1px;
      right: -1px;
      background: #fff;
      opacity: 0.35;
      content: "";
      border-radius: inherit;
      z-index: 1;
      -webkit-transition: opacity 0.2s;
      transition: opacity 0.2s;
      pointer-events: none;
      display: none;
    }

    .ant-alert {
      font-family: "Chinese Quote", -apple-system, BlinkMacSystemFont,
        "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
        "Helvetica Neue", Helvetica, Arial, sans-serif, "Apple Color Emoji",
        "Segoe UI Emoji", "Segoe UI Symbol";
      font-size: 14px;
      font-variant: tabular-nums;
      line-height: 1.5;
      color: rgba(0, 0, 0, 0.65);
      -webkit-box-sizing: border-box;
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      list-style: none;
      position: relative;
      padding: 8px 15px 8px 37px;
      border-radius: 4px;
    }

    .ant-alert-info {
      border: 1px solid #91d5ff;
      background-color: #e6f7ff;
    }

    .ant-alert-with-description {
      padding: 15px 15px 15px 64px;
      position: relative;
      border-radius: 4px;
      color: rgba(0, 0, 0, 0.65);
      line-height: 1.5;
    }

    .ant-alert-info .ant-alert-icon {
      color: #1890ff;
    }

    .ant-alert-with-description .ant-alert-icon {
      position: absolute;
      top: 16px;
      left: 24px;
      font-size: 24px;
    }

    .ant-alert-with-description .ant-alert-message {
      font-size: 16px;
      color: rgba(0, 0, 0, 0.85);
      display: block;
      margin-bottom: 4px;
    }

    .ant-alert-description {
      font-size: 14px;
      line-height: 22px;
      display: none;
    }

    .ant-alert-with-description .ant-alert-description {
      display: block;
    }

    .x-block {
      padding: 20px;
    }

    .x-button {
      margin-bottom: -32px;
      float: right;
      z-index: 2;
    }

    .x-alert {
      margin-bottom: 20px;
    }
  </style>
  <script>
      /** @Author: changge* @Date: 2017-08-15 11:07:05* @Last Modified by: changge* @Last Modified time: 2018-01-22 17:49:31*/ (function (
        global
      ) {
      var JSONTOEXCEL = (function () {
        var jsonToXLS = (function () {
          var xlsTemp =
            '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>${table}</table></body></html>';
          return function (dataSource, columns) {
            var xlsData = "",
              values = [];
            xlsData += "<thead>";
            columns.forEach(function (item) {
              xlsData += "<th>" + item.title + "</th>";
              if (item.computed && typeof item.computed === "function") {
                values.push(item.computed);
              } else {
                if (item.dataIndex && typeof item.dataIndex === "string") {
                  values.push(item.dataIndex);
                } else {
                  values.push(null);
                }
              }
            });
            xlsData += "</thead>";
            xlsData += "<tbody>";
            dataSource.forEach(function (item) {
              xlsData += "<tr>";
              values.forEach(function (key) {
                xlsData += "<td>";
                if (typeof key === "string") {
                  xlsData += item[key];
                } else {
                  if (typeof key === "function") {
                    xlsData += key(item) || "";
                  } else {
                    xlsData += "";
                  }
                }
                xlsData += "</td>";
              });
              xlsData += "</tr>";
            });
            xlsData += "</tbody>";
            return xlsTemp.replace("${table}", xlsData);
          };
        })();
        var jsonToCSV = function (dataSource, columns) {
          var csvData = "",
            values = [];
          columns.forEach(function (item) {
            if (item.computed && typeof item.computed === "function") {
              values.push(item.computed);
            } else {
              if (item.dataIndex && typeof item.dataIndex === "string") {
                values.push(item.dataIndex);
              } else {
                values.push(null);
              }
            }
          });
          dataSource.forEach(function (item) {
            values.forEach(function (key) {
              if (typeof key === "string") {
                csvData += item[key];
              } else {
                if (typeof key === "function") {
                  csvData += key(item) || "";
                } else {
                  csvData += "";
                }
              }
              csvData += ",";
            });
            csvData = csvData.slice(0, csvData.length - 1);
            csvData += "\r\n";
          });
          return csvData;
        };
        var base64 = function (s) {
          return window.btoa(window.unescape(encodeURIComponent(s)));
        };
        var exportXLS = function (dataSource, columns, fileName) {
          var XLSData =
            "data:application/vnd.ms-excel;base64," +
            base64(jsonToXLS(dataSource, columns));
          download(XLSData, fileName);
        };
        var exportCSV = function (dataSource, columns, fileName) {
          var CSVData =
            "data:application/csv;base64," +
            base64(jsonToCSV(dataSource, columns));
          download(CSVData, fileName);
        };
        var download = function (base64data, fileName) {
          if (window.navigator.msSaveBlob) {
            var blob = base64ToBlob(base64data);
            window.navigator.msSaveBlob(blob, filename);
            return false;
          }
          var alink = document.createElement("a");
          if (window.URL.createObjectURL) {
            var blob = base64ToBlob(base64data);
            var blobUrl = window.URL.createObjectURL(blob);
            alink.href = blobUrl;
            alink.download = fileName;
            alink.click();
            return;
          }
          if (alink.download === "") {
            alink.href = base64data;
            alink.download = fileName;
            alink.click();
            return;
          }
        };
        var base64ToBlob = function (base64Data) {
          var arr = base64Data.split(","),
            mime = arr[0].match(/:(.*?);/)[1],
            bstr = atob(arr[1]),
            n = bstr.length,
            u8arr = new Uint8Array(n);
          while (n--) {
            u8arr[n] = bstr.charCodeAt(n);
          }
          return new Blob([u8arr], { type: mime });
        };
        return { exportXLS: exportXLS, exportCSV: exportCSV };
      })();
      if (typeof define === "function" && define.amd) {
        define(function () {
          return JSONTOEXCEL;
        });
      } else {
        if (typeof exports !== "undefined") {
          if (typeof module !== "undefined" && module.exports) {
            exports = module.exports = JSONTOEXCEL;
          }
          exports.JSONTOEXCEL = JSONTOEXCEL;
        } else {
          global.JSONTOEXCEL = JSONTOEXCEL;
        }
      }
    })(this);
  </script>
  <script>!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.dayjs=n()}(this,function(){"use strict";var t="millisecond",n="second",e="minute",r="hour",i="day",s="week",u="month",o="quarter",a="year",h=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,f=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,c=function(t,n,e){var r=String(t);return!r||r.length>=n?t:""+Array(n+1-r.length).join(e)+t},d={s:c,z:function(t){var n=-t.utcOffset(),e=Math.abs(n),r=Math.floor(e/60),i=e%60;return(n<=0?"+":"-")+c(r,2,"0")+":"+c(i,2,"0")},m:function(t,n){var e=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(e,u),i=n-r<0,s=t.clone().add(e+(i?-1:1),u);return Number(-(e+(n-r)/(i?r-s:s-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(h){return{M:u,y:a,w:s,d:i,D:"date",h:r,m:e,s:n,ms:t,Q:o}[h]||String(h||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},$={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},l="en",m={};m[l]=$;var y=function(t){return t instanceof v},M=function(t,n,e){var r;if(!t)return l;if("string"==typeof t)m[t]&&(r=t),n&&(m[t]=n,r=t);else{var i=t.name;m[i]=t,r=i}return e||(l=r),r},g=function(t,n,e){if(y(t))return t.clone();var r=n?"string"==typeof n?{format:n,pl:e}:n:{};return r.date=t,new v(r)},D=d;D.l=M,D.i=y,D.w=function(t,n){return g(t,{locale:n.$L,utc:n.$u,$offset:n.$offset})};var v=function(){function c(t){this.$L=this.$L||M(t.locale,null,!0),this.parse(t)}var d=c.prototype;return d.parse=function(t){this.$d=function(t){var n=t.date,e=t.utc;if(null===n)return new Date(NaN);if(D.u(n))return new Date;if(n instanceof Date)return new Date(n);if("string"==typeof n&&!/Z$/i.test(n)){var r=n.match(h);if(r)return e?new Date(Date.UTC(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)):new Date(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)}return new Date(n)}(t),this.init()},d.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},d.$utils=function(){return D},d.isValid=function(){return!("Invalid Date"===this.$d.toString())},d.isSame=function(t,n){var e=g(t);return this.startOf(n)<=e&&e<=this.endOf(n)},d.isAfter=function(t,n){return g(t)<this.startOf(n)},d.isBefore=function(t,n){return this.endOf(n)<g(t)},d.$g=function(t,n,e){return D.u(t)?this[n]:this.set(e,t)},d.year=function(t){return this.$g(t,"$y",a)},d.month=function(t){return this.$g(t,"$M",u)},d.day=function(t){return this.$g(t,"$W",i)},d.date=function(t){return this.$g(t,"$D","date")},d.hour=function(t){return this.$g(t,"$H",r)},d.minute=function(t){return this.$g(t,"$m",e)},d.second=function(t){return this.$g(t,"$s",n)},d.millisecond=function(n){return this.$g(n,"$ms",t)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(t,o){var h=this,f=!!D.u(o)||o,c=D.p(t),d=function(t,n){var e=D.w(h.$u?Date.UTC(h.$y,n,t):new Date(h.$y,n,t),h);return f?e:e.endOf(i)},$=function(t,n){return D.w(h.toDate()[t].apply(h.toDate(),(f?[0,0,0,0]:[23,59,59,999]).slice(n)),h)},l=this.$W,m=this.$M,y=this.$D,M="set"+(this.$u?"UTC":"");switch(c){case a:return f?d(1,0):d(31,11);case u:return f?d(1,m):d(0,m+1);case s:var g=this.$locale().weekStart||0,v=(l<g?l+7:l)-g;return d(f?y-v:y+(6-v),m);case i:case"date":return $(M+"Hours",0);case r:return $(M+"Minutes",1);case e:return $(M+"Seconds",2);case n:return $(M+"Milliseconds",3);default:return this.clone()}},d.endOf=function(t){return this.startOf(t,!1)},d.$set=function(s,o){var h,f=D.p(s),c="set"+(this.$u?"UTC":""),d=(h={},h[i]=c+"Date",h.date=c+"Date",h[u]=c+"Month",h[a]=c+"FullYear",h[r]=c+"Hours",h[e]=c+"Minutes",h[n]=c+"Seconds",h[t]=c+"Milliseconds",h)[f],$=f===i?this.$D+(o-this.$W):o;if(f===u||f===a){var l=this.clone().set("date",1);l.$d[d]($),l.init(),this.$d=l.set("date",Math.min(this.$D,l.daysInMonth())).toDate()}else d&&this.$d[d]($);return this.init(),this},d.set=function(t,n){return this.clone().$set(t,n)},d.get=function(t){return this[D.p(t)]()},d.add=function(t,o){var h,f=this;t=Number(t);var c=D.p(o),d=function(n){var e=g(f);return D.w(e.date(e.date()+Math.round(n*t)),f)};if(c===u)return this.set(u,this.$M+t);if(c===a)return this.set(a,this.$y+t);if(c===i)return d(1);if(c===s)return d(7);var $=(h={},h[e]=6e4,h[r]=36e5,h[n]=1e3,h)[c]||1,l=this.$d.getTime()+t*$;return D.w(l,this)},d.subtract=function(t,n){return this.add(-1*t,n)},d.format=function(t){var n=this;if(!this.isValid())return"Invalid Date";var e=t||"YYYY-MM-DDTHH:mm:ssZ",r=D.z(this),i=this.$locale(),s=this.$H,u=this.$m,o=this.$M,a=i.weekdays,h=i.months,c=function(t,r,i,s){return t&&(t[r]||t(n,e))||i[r].substr(0,s)},d=function(t){return D.s(s%12||12,t,"0")},$=i.meridiem||function(t,n,e){var r=t<12?"AM":"PM";return e?r.toLowerCase():r},l={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:D.s(o+1,2,"0"),MMM:c(i.monthsShort,o,h,3),MMMM:h[o]||h(this,e),D:this.$D,DD:D.s(this.$D,2,"0"),d:String(this.$W),dd:c(i.weekdaysMin,this.$W,a,2),ddd:c(i.weekdaysShort,this.$W,a,3),dddd:a[this.$W],H:String(s),HH:D.s(s,2,"0"),h:d(1),hh:d(2),a:$(s,u,!0),A:$(s,u,!1),m:String(u),mm:D.s(u,2,"0"),s:String(this.$s),ss:D.s(this.$s,2,"0"),SSS:D.s(this.$ms,3,"0"),Z:r};return e.replace(f,function(t,n){return n||l[t]||r.replace(":","")})},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(t,h,f){var c,d=D.p(h),$=g(t),l=6e4*($.utcOffset()-this.utcOffset()),m=this-$,y=D.m(this,$);return y=(c={},c[a]=y/12,c[u]=y,c[o]=y/3,c[s]=(m-l)/6048e5,c[i]=(m-l)/864e5,c[r]=m/36e5,c[e]=m/6e4,c[n]=m/1e3,c)[d]||m,f?y:D.a(y)},d.daysInMonth=function(){return this.endOf(u).$D},d.$locale=function(){return m[this.$L]},d.locale=function(t,n){if(!t)return this.$L;var e=this.clone(),r=M(t,n,!0);return r&&(e.$L=r),e},d.clone=function(){return D.w(this.$d,this)},d.toDate=function(){return new Date(this.valueOf())},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},c}();return g.prototype=v.prototype,g.extend=function(t,n){return t(n,v,g),g},g.locale=M,g.isDayjs=y,g.unix=function(t){return g(1e3*t)},g.en=m[l],g.Ls=m,g});</script>
</head>

<body>
  <div class="x-block">
    <div data-show="true" class="ant-alert ant-alert-info ant-alert-with-description x-alert">
      <i class="anticon anticon-info-circle-o ant-alert-icon"></i>
      <span
        class="ant-alert-message">用途：本页面用于帮助解析银行出入金内容，可自动解析出“備考”，“出入金内容（中文）”，“属性”，“凭证”。 </span><span
        class="ant-alert-description">
        使用方法：
        <ul>
          <li>
            ① 把从银行下载下来的 Excel 文件打开，复制“会社名”、“入出金(円)”、“入出金先内容”列的内容。
            <ul>
              <li>
                注意：不同银行对“入出金先内容”的称呼不同，我们内部统称为“入出金先内容”。
              </li>
              <li>例如：</li>
              <li>
                <table>
                  <tr>
                    <td>三井住友銀行</td>
                    <td>→</td>
                    <td>依頼人名／契約者番号</td>
                  </tr>
                  <tr>
                    <td>みずほ銀行</td>
                    <td>→</td>
                    <td>お取引内容</td>
                  </tr>
                  <tr>
                    <td>ジャパンネット銀行</td>
                    <td>→</td>
                    <td>摘要</td>
                  </tr>
                </table>
              </li>
            </ul>
          </li>
          <li>② 粘贴进本页面以下方框中。</li>
          <li>③ 点击“导出 Excel”</li>
        </ul>
      </span>
    </div>
    <button type="button" class="ant-btn ant-btn-primary x-button" id="J_Cal">
      <span>导出 Excel</span>
    </button>
<textarea rows="20" class="ant-input x-input" name="a" id="a" placeholder="粘贴整份内容到这里">
</textarea>
<div id="b-title" style="display: none;margin-top:20px" data-show="true" class="ant-alert ant-alert-info ant-alert-with-description x-alert">
  <i class="anticon anticon-info-circle-o ant-alert-icon"></i>
  <span
    class="ant-alert-message">入出金替换规则👇，如有更新可直接修改
  </span>
</div>
<textarea style="display: none; margin-top: 20px" rows="20" class="ant-input x-input" name="b" id="b"
      placeholder="粘贴整一列到这里">
ナカムラカイケイシ゛ムシヨ&&コンフォート&&-44000	税理士先生報酬	税理士工资	人员工资	不要
商品代金倉庫料税金の立替金の返し&&理研日伸&&<0	商品代金倉庫料税金など	商品.仓储物流税金等费用	商品+税金+物流费用的支出	不要
商品代金倉庫料税金の立替金の返し&&コンフォート&&<0	商品代金倉庫料税金など	商品.仓储物流税金等费用	商品+税金+物流费用的支出	不要
商品代金倉庫料税金の立替金の返し&&羽夢&&<0	商品代金倉庫料税金など	商品.仓储物流税金等费用	商品+税金+物流费用的支出	不要
商品代金倉庫料税金の立替金の返し&&美羽&&>0	商品代金倉庫料税金などの入金	商品.仓储物流税金等费用	商品+税金+物流费用收回	不要
アマゾンジヤパン（ド&&ANY&&>0	アマゾン売上	amazon销售额进账	销售额进账	要
アメックス&&ANY&&<0	クレジットカード決済部分への返金	还信用卡的支出	办公支出	要
アメリカン&&ANY&&<0	クレジットカード決済部分への返金	还信用卡的支出	办公支出	要
ラクテン（カ　フ゛ツリユウ　ヘ゛ンサイ&&ANY&&>0	庫内事故の弁済金	赔偿金	其他收入	要
ラクテン（カ　フ゛ツリユウ　タ゛イヒ゛キ&&ANY&&>0	代引き売上	货到付款销售额进账	销售额进账	要
ヤフ－シヨツピングコウザユウコウセイカクニン&&ANY&&<0	口座確認	确认银行账户	办公支出	要
4535355&&ANY&&<0	コンテナ通関税金など	关税消费税等	税务支出	要
3614002&&ANY&&<0	倉庫利用料	仓储物流费用	仓储物流费用	要
ラクテンカフ゛シキカ゛イシヤ&&ANY&&<0	楽天システム利用料	乐天系统使用费	平台费用	要
ｼﾔｶｲﾎｹﾝﾘﾖｳ&&ANY&&<0	社会保险料	保险费	办公支出	不要
（カ）シ゛エ－シ－ヒ゛－&&ANY&&<0	クレジットカード決済部分への返金	信用卡还款	办公支出	要
ﾌﾘｺﾐﾃｽｳﾘﾖｳ&&ANY&&<0	手数料	手续费	办公支出	要
振込手数料&&ANY&&<0	手数料	手续费	办公支出	要
テクニカルノア&&ANY&&<0	国際宅配便税金など	国际快递的关税消费税	税务支出	要
カイガイソウキン&&ANY&&<0	海外送金（親会社へ仕入れ代金の送金）	向胜利汇钱	支付货款	不要
ラクテンヘ゜イ　イチハ゛&&ANY&&>0	楽天pay売上	楽天pay销售额进账	销售额进账	要
シラトリセイメンシヨ&&ANY&&<0	羽毛布団リフォーム代	羽绒被翻新费用	办公支出	要
ヤフ－　ヒ゛シ゛ネスサ－ヒ゛ス&&ANY&&>0	yahoo売上	yahoo销售额进账	销售额进账	要
振込 バリューコマース（カ&&ANY&&<0	yahoo広告費	yahoo广告费	广告费	要
ＡＵコマ－ス&&ANY&&<0	wowmaシステム利用料3WO	wowma系统使用费	平台费用	要
AUｺﾏ-ｽ&&ANY&&<0	wowmaシステム利用料1WO	wowma系统使用费	平台费用	要
7018655　ＧＭＯメイクショップ&&ANY&&<0	makeshop広告費	makeshop广告费	平台费用	要
ｲﾌﾟｼﾛﾝ&&ANY&&<0	makeshop利用料	makeshop平台使用费	平台费用	要
ﾗｸﾃﾝﾓﾊﾞｲ&&ANY&&<0	IP電話料金	IP电话的话费	办公支出	要
利息&&ANY&&>0	利息	利息	利息	不要
ﾌﾂｳﾖｷﾝ ﾘｿｸ&&ANY&&>0	利息	利息	利息	不要
ｴ-ﾕ-ｺﾏ-ｽ&&ANY&&>0	wowma売上入金	wowma销售额进账	销售额进账	要
ﾍﾟｲｼﾞｴﾝﾄ ﾌﾘｺﾐ&&ANY&&>0	wowma売上入金	wowma销售额进账	销售额进账	要
家賃&&羽夢&&82550	美羽からの家賃	美羽归还给羽梦的房租	办公支出	不要
ＳＭＢＣ（ＮＩヤチン&&羽夢&&-165100	事務所家賃	事务所租金	办公支出	不要
タ゛フ゛ルケイ&&理研日伸&&-10000	事務所家賃	事务所租金	办公支出	不要
カ）ペイジエント&&ANY&&>0	wowma売上入金	wowma销售额进账	销售额进账	要
ｴ-ﾕ-ｺﾏ-ｽ&&ANY&&>0	wowma売上入金	wowma销售额进账	销售额进账	要
ﾍﾟｲｼﾞｴﾝﾄ&&ANY&&>0	wowma売上入金	wowma销售额进账	销售额进账	要
ジ－エムオ－イプシロン（カ&&ANY&&>0	makeshop売上	makeshop销售额	销售额进账	要
シ゛－エムオ－メイクシヨツフ゜（カ&&ANY&&>0	makeshop売上	makeshop销售额	销售额进账	要
アマゾンジヤパンゴウドウガイシヤ&&ANY&&>0	アマゾン売上	amazon销售额进账	销售额进账	要
ｱﾏｿﾞﾝｼﾞﾔﾊﾟﾝｺﾞｳﾄﾞｳｶﾞｲ ﾌﾘｺﾐ&&ANY&&>0	アマゾン売上	amazon销售额进账	销售额进账	要
タケタ゛　ツヨシ&&TMC&&-30000	役員報酬	法人代表报酬	人员工资	不要
モリタ　タケシ&&TMC&&-100000	役員報酬	法人代表报酬	人员工资	不要
0007313　ツルオカ　マツヨ&&TMC&&-73000	家賃	事务所租金	办公支出	不要
家賃&&美羽&&-82550	家賃	事务所租金	办公支出	不要
ＸＵ　ＹＡＮＲＵ&&美羽&&-196305	役員報酬	法人代表报酬	人员工资	不要
1898582　徐　燕如&&美羽&&-196305	役員報酬	法人代表报酬	人员工资	不要
カナムロ　テルヒコ&&理研日伸&&-400000	役員報酬	法人代表报酬	人员工资	不要
ニシムラ　シンコ゛&&羽夢&&-9390	役員報酬	法人代表报酬	人员工资	不要
タケタ゛ツヨシセ゛イリシシ゛ムシヨ&&理研日伸&&-17963	税理士先生報酬	税理士工资	人员工资	不要
1164484　タニガワ　エイイチ&&コンフォート&&-327263	給料	人员工资	人员工资	不要
1164484　タニカ゛ワ　エイイチ&&コンフォート&&-327263	給料	人员工资	人员工资	不要
タケタ゛ツヨシセ゛イリシシ゛ムシヨ&&コンフォート&&-44000	税理士先生報酬	税理士工资	人员工资	不要
ナカムラカイケイシ゛ムシヨ&&羽夢&&-22000	税理士先生報酬	税理士工资	人员工资	不要
タニカ゛ワ　ケイイチ&&美羽&&-5816	アルバイト料	人员工资	人员工资	不要
ナカムラカイケイシ゛ムシヨ&&美羽&&-61260	源泉税	源泉税	税务支出	不要
ナカムラカイケイシ゛ムシヨ&&美羽&&-55000	税理士先生報酬	税理士工资	人员工资	不要


</textarea>
  </div>
  <script>
    if (~location.search.indexOf("debug")) {
      document.getElementById("b-title").style.display = "block";
      document.getElementById("b").style.display = "block";
    }
    document.getElementById("a").select();
    const s = "	";

    document.getElementById("J_Cal").addEventListener("click", function (ev) {
      const b = document.getElementById("b");
      let map = [];
      b.value
        .trim()
        .split("\n")
        .forEach((item) => {
          const itemMap = item.trim().split(s);
          map.push({
              /*入出金先内容的 keyword*/ keywords: itemMap[0]
              ? itemMap[0].trim().split("&&")
              : [],
              /*属性*/ type: itemMap[1] || "",
              /*备注（中文）*/ type_cn: itemMap[2] || "",
              /*備考（日本語）*/ group: itemMap[3] || "",
              /*凭证*/ certificate: itemMap[4] || "",
          });
        });
      const a = document.getElementById("a");
      const aMap = a.value.trim().split("\n");
      const getType = function (typeName) {
        const nameArr = typeName.split(s);
        let [company, date, cost, name] = nameArr;
        
        if(cost != 'ANY'){
          if(cost.indexOf(',') > -1){
            cost = +cost.replace(/,/ig,'')
          } else {
            cost = +cost
          }
        }
        
        let item = {
          name,
          company,
          type: "#N/A",
          cost,
          date: dayjs(date).set('hour',12).format('YYYY-MM-DD HH:mm:ss'),
          cost_in: (cost > 0) ? cost:'',
          cost_out: (cost < 0) ? cost:'',
          type_cn: "#N/A",
          group: "#N/A",
          certificate: "#N/A",
        };
        map.forEach((m) => {
          if (
            name.replace(/\s+/g, ' ').indexOf(m.keywords[0].replace(/\s+/g, ' ')) > -1
            &&
            (!m.keywords[1] || ((m.keywords[1] == 'ANY') || (company.indexOf(m.keywords[1]) > -1)))
            &&
            (!m.keywords[2] || ((m.keywords[2] == 'ANY') || (m.keywords[2] == '<0' && cost <0) || (m.keywords[2] == '>0' && cost > 0) || (m.keywords[2] == cost)))
          ) {
            item = m;
            item.company = company;
            item.cost = cost;
            item.date = dayjs(date).set('hour',12).format('YYYY-MM-DD HH:mm:ss')
            
            if(cost > 0){
              item.cost_in = cost;
              item.cost_out = '';
            }
            
            if(cost < 0){
              item.cost_out = cost;  
              item.cost_in = '';
            }
            item.name = name;
          }
        });
        return item;
      };
      const dataSource = aMap.map((item) => {
        const matched = getType(item);
        return {
          name: matched.name,
          date: matched.date,
          type: matched.type,
          company: matched.company,
          cost: matched.cost,
          cost_in: matched.cost_in,
          cost_out: matched.cost_out,
          type_cn: matched.type_cn,
          group: matched.group,
          certificate: matched.certificate,
        };
      });
      const columns = [
        { title: "会社名", dataIndex: "company" },
        { title: "新取引日", dataIndex: "date" },
        { title: "入出金(円)", dataIndex: "cost" },
        { title: "入金(円)", dataIndex: "cost_in" },
        { title: "出金(円)", dataIndex: "cost_out" },
        { title: "入出金先内容", dataIndex: "name" },
        { title: "備考", dataIndex: "type" },
        { title: "出入金内容（中文）", dataIndex: "type_cn" },
        { title: "属性", dataIndex: "group" },
        { title: "凭证", dataIndex: "certificate" },
      ];
      JSONTOEXCEL.exportXLS(dataSource, columns, "入出金解析.xls");
    });
  </script>
</body>

</html>
